(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[516],{8549:function(e,o,t){Promise.resolve().then(t.bind(t,5613))},5613:function(e,o,t){"use strict";t.d(o,{PageClientImpl:function(){return g}});var n,s=t(4048),r=t(8787),i=t(7324),a=t(2104),c=t(6397);function u(){let e=(0,a.Y)(),[o,t]=c.useState(!1);return c.useEffect(()=>{e!==o&&(t(e),e&&window.alert("This meeting is being recorded"))},[e]),(0,s.jsx)("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",boxShadow:e?"red 0px 0px 0px 3px inset":"none",pointerEvents:"none"}})}var d=t(431),l=t(3718),h=t(460),p=t(2811),v=t(3717),m=t(2157),f=t(2780);let E=null!==(n=f.env.NEXT_PUBLIC_CONN_DETAILS_ENDPOINT)&&void 0!==n?n:"/api/connection-details",b="true"==f.env.NEXT_PUBLIC_SHOW_SETTINGS_MENU;function g(e){let[o,t]=c.useState(void 0),n=c.useMemo(()=>({username:"",videoEnabled:!0,audioEnabled:!0}),[]),[r,i]=c.useState(void 0),a=c.useCallback(async o=>{t(o);let n=new URL(E,window.location.origin);n.searchParams.append("roomName",e.roomName),n.searchParams.append("participantName",o.username),e.region&&n.searchParams.append("region",e.region);let s=await fetch(n.toString());i(await s.json())},[]),u=c.useCallback(e=>console.error(e),[]);return(0,s.jsx)("main",{"data-lk-theme":"default",style:{height:"100%"},children:void 0===r||void 0===o?(0,s.jsx)("div",{style:{display:"grid",placeItems:"center",height:"100%"},children:(0,s.jsx)(l.tt,{defaults:n,onSubmit:a,onError:u})}):(0,s.jsx)(C,{connectionDetails:r,userChoices:o,options:{codec:e.codec,hq:e.hq}})})}function C(e){let o=(0,r.FZ)(location.hash.substring(1)),n=o&&new Worker(t.tu(new URL(t.p+t.u(647),t.b))),a=!!(o&&n),f=new v.P6,[E,g]=c.useState(!1),C=c.useMemo(()=>{var o,t;let s=e.options.codec?e.options.codec:"vp9";return a&&("av1"===s||"vp9"===s)&&(s=void 0),{videoCaptureDefaults:{deviceId:null!==(o=e.userChoices.videoDeviceId)&&void 0!==o?o:void 0,resolution:e.options.hq?v.OM.h2160:v.OM.h720},publishDefaults:{dtx:!1,videoSimulcastLayers:e.options.hq?[v.OM.h1080,v.OM.h720]:[v.OM.h540,v.OM.h216],red:!a,videoCodec:s},audioCaptureDefaults:{deviceId:null!==(t=e.userChoices.audioDeviceId)&&void 0!==t?t:void 0},adaptiveStream:{pixelDensity:"screen"},dynacast:!0,e2ee:a?{keyProvider:f,worker:n}:void 0}},[e.userChoices,e.options.hq,e.options.codec]),x=c.useMemo(()=>new v.du(C),[]);c.useEffect(()=>{a?f.setKey((0,r.FZ)(o)).then(()=>{x.setE2EEEnabled(!0).catch(e=>{if(e instanceof v.Fc)alert("You're trying to join an encrypted meeting, but your browser does not support it. Please update it to the latest version and try again."),console.error(e);else throw e})}).then(()=>g(!0)):g(!0)},[a,x,o]);let S=c.useMemo(()=>({autoSubscribe:!0}),[]),w=(0,m.useRouter)(),k=c.useCallback(()=>w.push("/"),[w]),y=c.useCallback(e=>{console.error(e),alert("Encountered an unexpected error, check the console logs for details: ".concat(e.message))},[]),N=c.useCallback(e=>{console.error(e),alert("Encountered an unexpected encryption error, check the console logs for details: ".concat(e.message))},[]);return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(h.L,{connect:E,room:x,token:e.connectionDetails.participantToken,serverUrl:e.connectionDetails.serverUrl,connectOptions:S,video:e.userChoices.videoEnabled,audio:e.userChoices.audioEnabled,onDisconnected:k,onEncryptionError:N,onError:y,children:[(0,s.jsx)(l.zc,{chatMessageFormatter:p.m,SettingsComponent:b?d.T:void 0}),(0,s.jsx)(i.a,{}),(0,s.jsx)(u,{})]})})}},2157:function(e,o,t){"use strict";var n=t(5833);t.o(n,"useRouter")&&t.d(o,{useRouter:function(){return n.useRouter}}),t.o(n,"useSearchParams")&&t.d(o,{useSearchParams:function(){return n.useSearchParams}})}},function(e){e.O(0,[503,410,433,657,510,342,744],function(){return e(e.s=8549)}),_N_E=e.O()}]);
//# sourceMappingURL=page-88e54e10fdcb811c.js.map