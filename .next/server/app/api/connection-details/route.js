"use strict";(()=>{var e={};e.id=603,e.ids=[603],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2254:e=>{e.exports=require("node:buffer")},6005:e=>{e.exports=require("node:crypto")},7261:e=>{e.exports=require("node:util")},9187:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>P,requestAsyncStorage:()=>f,routeModule:()=>h,serverHooks:()=>x,staticGenerationAsyncStorage:()=>g});var n={};r.r(n),r.d(n,{GET:()=>m});var a=r(6126),o=r(9184),i=r(6197),s=r(459),p=r(1602);let u=process.env.LIVEKIT_API_KEY,c=process.env.LIVEKIT_API_SECRET,l=process.env.LIVEKIT_URL,d="random-participant-postfix";async function m(e){try{var t,r;let n=e.nextUrl.searchParams.get("roomName"),a=e.nextUrl.searchParams.get("participantName"),o=e.nextUrl.searchParams.get("metadata")??"",i=e.nextUrl.searchParams.get("region"),m=i?function(e){let t="LIVEKIT_URL";e&&(t=`LIVEKIT_URL_${e}`.toUpperCase());let r=process.env[t];if(!r)throw Error(`${t} is not defined`);return r}(i):l,h=e.cookies.get(d)?.value;if(void 0===m)throw Error("Invalid region");if("string"!=typeof n)return new p.NextResponse("Missing required query parameter: roomName",{status:400});if(null===a)return new p.NextResponse("Missing required query parameter: participantName",{status:400});h||(h=function(e){let t="",r="abcdefghijklmnopqrstuvwxyz0123456789",n=r.length;for(let e=0;e<4;e++)t+=r.charAt(Math.floor(Math.random()*n));return t}(0));let f=await function(e,t){let r=new s.JO(u,c,e);return r.ttl="5m",r.addGrant({room:t,roomJoin:!0,canPublish:!0,canPublishData:!0,canSubscribe:!0}),r.toJwt()}({identity:`${a}__${h}`,name:a,metadata:o},n);return new p.NextResponse(JSON.stringify({serverUrl:m,roomName:n,participantToken:f,participantName:a}),{headers:{"Content-Type":"application/json","Set-Cookie":`${d}=${h}; Path=/; HttpOnly; SameSite=Strict; Secure; Expires=${(r=(t=new Date).getTime(),t.setTime(r+72e5),t.toUTCString())}`}})}catch(e){if(e instanceof Error)return new p.NextResponse(e.message,{status:500})}}let h=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/connection-details/route",pathname:"/api/connection-details",filename:"route",bundlePath:"app/api/connection-details/route"},resolvedPagePath:"D:\\meet\\app\\api\\connection-details\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:f,staticGenerationAsyncStorage:g,serverHooks:x}=h,v="/api/connection-details/route";function P(){return(0,i.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:g})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[651,412],()=>r(9187));module.exports=n})();