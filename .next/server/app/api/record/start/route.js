"use strict";(()=>{var e={};e.id=826,e.ids=[826],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2254:e=>{e.exports=require("node:buffer")},6005:e=>{e.exports=require("node:crypto")},7261:e=>{e.exports=require("node:util")},4417:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>x,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>l});var s={};r.r(s),r.d(s,{GET:()=>p});var o=r(6126),a=r(9184),n=r(6197),i=r(459),u=r(1602);async function p(e){try{let t=e.nextUrl.searchParams.get("roomName");if(null===t)return new u.NextResponse("Missing roomName parameter",{status:403});let{LIVEKIT_API_KEY:r,LIVEKIT_API_SECRET:s,LIVEKIT_URL:o,S3_KEY_ID:a,S3_KEY_SECRET:n,S3_BUCKET:p,S3_ENDPOINT:c,S3_REGION:d}=process.env,l=new URL(o);l.protocol="https:";let m=new i.rj(l.origin,r,s),g=await m.listEgress({roomName:t});if(g.length>0&&g.some(e=>e.status<2))return new u.NextResponse("Meeting is already being recorded",{status:409});let x=new i.eS({filepath:`${new Date(Date.now()).toISOString()}-${t}.mp4`,output:{case:"s3",value:new i.V3({endpoint:c,accessKey:a,secret:n,region:d,bucket:p})}});return await m.startRoomCompositeEgress(t,{file:x},{layout:"speaker"}),new u.NextResponse(null,{status:200})}catch(e){if(e instanceof Error)return new u.NextResponse(e.message,{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/record/start/route",pathname:"/api/record/start",filename:"route",bundlePath:"app/api/record/start/route"},resolvedPagePath:"D:\\meet\\app\\api\\record\\start\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:m}=c,g="/api/record/start/route";function x(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:l})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[651,412],()=>r(4417));module.exports=s})();